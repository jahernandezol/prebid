
<html>

    <head>
        <title>Individual Ad Unit Refresh Example</title>
        <script async src="//www.googletagservices.com/tag/js/gpt.js"></script>
        <script async src="//static.azteca.com/portal/scripts/prebid2.1.0.js"></script>
        <script>
            var desktopSizes = [
                 [300, 600],
                 [300, 250]
             ];
             var tabletSizes = [
                 [300, 250]
             ];
             var phoneSizes = [
                 [320, 100],
                 [320, 50]
             ];
             var sizes = [
                 [320, 100],
                 [320, 50],
                 [300, 600],
                 [300, 250]
             ];

            var PREBID_TIMEOUT = 5000;

            var googletag = googletag || {};
            googletag.cmd = googletag.cmd || [];

            googletag.pubads().disableInitialLoad();

            var pbjs = pbjs || {};
            pbjs.que = pbjs.que || [];

            var adUnits = [{
                code: '/29782907/ADN-40/Home-Adn40',
                mediaTypes: {
                    banner: {
                        sizes: sizes
                    }
                },
                bids: [{
                    bidder: 'appnexus',
                    params: {
                        placementId: 16818116
                    }
                }]
            }];

            pbjs.que.push(function() {
                pbjs.addAdUnits(adUnits);
                pbjs.setConfig({
                    sizeConfig: [{
                        'mediaQuery': '(min-width: 1025px)',
                        'sizesSupported': desktopSizes,
                        'labels': ['desktop']
                    }, {
                        'mediaQuery': '(min-width: 768px) and (max-width: 1024px)',
                        'sizesSupported': tabletSizes,
                        'labels': ['tablet']
                    }, {
                        'mediaQuery': '(min-width: 320px) and (max-width: 812px)',
                        'sizesSupported': phoneSizes,
                        'labels': ['phone']
                    }]
                });
            });

        </script>

        <script>
        // Function to generate unique names for slots
        var nextSlotId = 1;
        function generateNextSlotName() {
        var id = nextSlotId++;
        return 'adslot' + id;
        }


        function refreshBid() {
            // Generate next slot name
            var slotName = generateNextSlotName();

            var adUnits = [{
                code: slotName,
                mediaTypes: {
                    banner: {
                        sizes: sizes
                    }
                },
                bids: [{
                    bidder: 'appnexus',
                    params: {
                        placementId: 16818116
                    }
                }]
            }];

            pbjs.que.push(function() {
                pbjs.addAdUnits(adUnits);
                pbjs.setConfig({
                    sizeConfig: [{
                        'mediaQuery': '(min-width: 1025px)',
                        'sizesSupported': desktopSizes,
                        'labels': ['desktop']
                    }, {
                        'mediaQuery': '(min-width: 768px) and (max-width: 1024px)',
                        'sizesSupported': tabletSizes,
                        'labels': ['tablet']
                    }, {
                        'mediaQuery': '(min-width: 320px) and (max-width: 812px)',
                        'sizesSupported': phoneSizes,
                        'labels': ['phone']
                    }]
                });
            });



            // Create a div for the slot
            var slotDiv = document.createElement('div');
            slotDiv.id = slotName; // Id must be the same as slotName
            document.body.appendChild(slotDiv);

            // Create and add fake content 1
            var h1=document.createElement("H2")
            var text1=document.createTextNode("Dynamic Fake Content 1");
            h1.appendChild(text1);
            document.body.appendChild(h1);

            // Create and add fake content 2
            var h2=document.createElement("H2")
            var text2=document.createTextNode("Dynamic Fake Content 2");
            h2.appendChild(text2);
            document.body.appendChild(h2);
            var slot1;
            googletag.cmd.push(function() {

              var mapping = googletag.sizeMapping().
              addSize([320, 0], [[320,50],[320,100]]).
              addSize([768, 200], [300, 250]). // Tablet
              addSize([1025, 200], [[300,250],[300,600]]). // Desktop
              build();

                slot1 = googletag.defineSlot('/29782907/ADN-40/Home-Adn40', [[300, 250]], slotName).
                  defineSizeMapping(mapping).
                  addService(googletag.pubads());

                googletag.pubads().enableSingleRequest();
                googletag.enableServices();
            });


                pbjs.que.push(function() {
                    pbjs.requestBids({
                        timeout: PREBID_TIMEOUT,
                        adUnitCodes: [slotName],
                        bidsBackHandler: function() {
                            pbjs.setTargetingForGPTAsync([slotName]);
                            googletag.pubads().refresh([slot1]);
                        }
                    });
                });
            }

        </script>
    </head>

    <body>
        <h1>Individual Ad Unit Refresh Example</h1>
        <h5>Div-1</h5>
        <!-- More initial fake content -->
 <text>
  <h2> Initial Fake Content 1 </h2>
  <h2> Initial Fake Content 2 </h2>
 </text>

 <!-- Button to load more content dynamically. -->
 <button onclick="refreshBid()">More Content</button>

    </body>

</html>
